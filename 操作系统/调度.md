# 处理机调度的基本概念

当计算机系统是多道程序设计系统时，通常就会有多个进程或线程同时竞争 CPU。只要是有两个或更多的进程处于就绪状态，这种情形就会发生。如果只有一个 CPU 可用，就必须选择下一个要运行的进程。在操作系统中，完成选择工作的这一部分称为调度程序，该程序使用的算法称为调度算法。

- 进程行为：几乎所有进程的 I/O 请求和计算都是交替突发的。
- 何时调度：
  - 创建一个新进程之后，需要决定是运行父进程还是运行子进程
  - 一个进程退出时
  - 当一个进程阻塞在 I/O 和信号量上或由于其他原因阻塞时
  - 在一个 I/O 中断发生时

如果硬件时钟提供周期性中断，可以在每个时钟中断或者在每 k 个时钟中断时做出调度决策。

- 非抢占式调度：选择一个进程，然后让该进程运行直至被阻塞，或者直到该进程自动释放 CPU
- 抢占式调度：选择一个进程，并且让该进程运行某个固定时段的最大值。如果在该时段结束时，该进程仍在运行，它就被挂起，而调度程度挑选另一个进程运行（如果存在一个就绪进程）

## 调度算法的目标

操作系统的分类：

- 批处理
- 交互式
- 实时

所有系统：

- 公平：给每个进程公平的 CPU 份额
- 策略强制执行：保证规定的策略被执行
- 平衡；保持系统的所有部分都忙碌

批处理系统：

- 吞吐量：每小时最大作业数
- 周转时间：从提交到终止间的最小时间
- CPU 利用率：保持 CPU 始终忙碌

交互式系统

- 响应时间：快速响应请求
- 均衡性：满足用户的期望

实时系统

- 满足截止时间：避免丢失数据
- 可预测性：在多媒体系统中避免品质降低

# 批处理系统的调度

计算公式：

- 完成时间=开始时间+服务时间
- 周转时间=完成时间-到达时间
- 带权周转时间=周转时间/服务时间

## 先来先服务

按照进程请求 CPU 的顺序使用 CPU，排在就绪队列队头的进程运行它所期望的时间长度，当正在运行的进程被阻塞时，就绪队列中的第一个进程接着运行，当被阻塞的进程变为就绪时，它就像一个新来的进程一样，排在就绪队列的末尾。

- 优点：易于理解、方便实现
- 缺点：资源利用率低、影响响应时间

## 最短作业优先

进程开始获取 CPU 一直运行直到完成或者由于某事件被阻塞放弃 CPU，运行结束后从当前就绪队列选择“最短”的进程运行。该调度算法适用于运行时间可以预知的任务。

- 优点：利于短进程、可以有效减少周转时间
- 缺点：长进程可能由于得不到 CPU 而“饿死”
