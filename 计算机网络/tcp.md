# 三次握手
传输层主要建立端到端的连接  
https端口号443
套接字socket是核心  
使用tcp连接需要进行三次握手，什么样的握手才能判断出哪些请求或哪些响应需要丢弃是握手机制的核心。
tcp报文里面有SYN,ACK,FIN等标识。
客户端在发送报文的时候会把SYN（synchronization 同步）开启，客户端想和服务端进行数据的同步。
在同步以后，也就是三次握手以后，客户端就可以和服务端互相发送信息。  
TCP是全双工的，所以可以互发信息。  
报文里面还有一个重要的字段Sequence序号，因为应用程序可能连续发送多个序号给服务器，
这样服务器有依据判断哪些是累赘信息。Sequence序号是随机生成的，作为初始值来进行后续判断依据，保证通道的唯一性。    
客户端 SYN=> 服务端   
服务端 SYN+ACK（Acknowlegementque确认）=>客户端   
客户端 ACK =>服务端   

**确认号就是对方的序号+1得到的，第三次握手的序号是自己的序号+1。**

----
DDos攻击：不断发送SYN不进行下一步操作，就会导致服务器原地崩溃。   
服务器不保存自己的序号，而是根据服务器的IP地址和端口号等私有信息进行算法的运算得到序号。
# 四次挥手
客户端和服务端都能发送关闭请求。  
假设客户端先发送关闭请求。   
客户端会在报文中开启FIN（finish）,ACK两个控制位。   
因为在发送http请求和响应的时候序号和确认号被不断递增，因此这里就不用固定数字来表示序号和确认号了。   
一般服务端会先发送一个ACK来进行确认 。   
四次挥手是为避免有未发送完的数据。
**自己的序号用对方的确认号，自己的确认号用对方的确认号+1。**
客户端（序号 确认号） FIN+ACK => 服务端
客户端    ACK=>  服务端（序号：对方的确认号，确认号对方的序号+1）
客户端    FIN+ACK=> 服务端（不变）
客户端 （序号：对方的确认号，确认号：对方的序号+1）   ACK=> 服务端
   
[tcp三次握手](https://www.bilibili.com/video/BV18h41187Ep?from=search&seid=14821919466130672603&spm_id_from=333.337.0.0)